<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign Up Page</title>
    </head>
<body>
    <h1>Sign Up</h1>

    <form id="signupForm">
        <div>
            <label for="email">Email:</label>
            <input type="email" id="email" name="email" required>
        </div>
        <div>
            <label for="password">Password:</label>
            <input type="password" id="password" name="password" required>
        </div>
        <button type="submit">Sign Up</button>
    </form>

    <p>Already have an account? <a href="login.html">Login</a></p>

    <script type="module">
   // THIS IMPORT MUST BE THE VERY FIRST THING IN THE SCRIPT BLOCK
   import { supabase } from './supabase.js'; // NOTE: It should be `export const supabase` in your supabase.js, so you import with curly braces `{ supabase }` here.

   // 1. Alert that the script is loading. This should be the first alert you see.
   alert('1. Signup Script is loading!');

   // 2. Alert that Supabase has been imported.
   alert('2. Signup: Supabase is ready!');

   // Get the form element.
   const form = document.getElementById('signupForm');

   // 3. Alert to check if the form element was found.
   alert('3. Signup: Form found? ' + (form ? 'YES' : 'NO')); // Will say YES or NO

   // Attach the event listener to the form's submit event.
   if (form) { // Add this check just in case the form wasn't found
       form.addEventListener('submit', async (e) => {
           // 4. Alert that the button was tapped (inside the event listener).
           alert('4. Signup: Sign Up button was tapped!');

           e.preventDefault(); // Stop the page from reloading on form submit

           // Get the values from the email and password input fields.
           const email = document.getElementById('email').value;
           const password = document.getElementById('password').value;

           // 5. Alert showing the email and password length being used.
           alert('5. Signup: Attempting signup with Email: ' + email + ' and Password length: ' + password.length);

           // Call the Supabase signup function.
           const { data, error } = await supabase.auth.signUp({
               email: email,
               password: password,
           });

           if (error) {
               // 6. Alert for failed signup with the error message from Supabase.
               alert('6. Signup FAILED! Error: ' + error.message);
               console.error('Sign up error:', error); // This won't be seen on your phone, but good for when you get a computer.
           } else {
               // 6. Alert for successful signup.
               alert('6. Signup SUCCESS! Please check your email to confirm.');
               window.location.href = 'login.html'; // Redirect to login page.
           }
       });
   } else {
       alert('Error: Signup form not found by ID!'); // This will tell us if the form ID is wrong
   }
</script>

</body>
</html>

